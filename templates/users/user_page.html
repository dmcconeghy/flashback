{% extends 'base.html' %}

{% block title %}{{ user.username }}{% endblock %}

{% block content %}
  <div class="container-fluid col-12">
  <div class="row user-info pt-4">
    <div class="col-9">
      <h2>Hello {{ user.username }}</h2>
    </div>
    
  </div>

  <div class="row">
    <div class="col-4 col-md-2 col-lg-2"><img src="{{user.profile_img_url}}" height="auto" class="img-fluid mx-auto d-block"></div>
    <div class="col-12 col-md-10 col-lg-9 container ml-0 pl-2">
      <div class="row favorite-song-label">
        <div class="h4 col container pt-4 text-left">Your {{favorites | length}} favorite songs:</div>
      </div>
      <div class="row">
        <div class="container-fluid col-md-6 col-lg-6">
          <ul> 
              {% for song in songs %}
              <div class="row col">
                <li>
                  <span>
                  <a href="/song/{{song.id}}" class="h6">{{song.title}}</a> by {{song.artist | truncate(25)}}
                    <form method="POST" 
                      action="/users/{{user.id}}/removefavorite/{{song.id}}" 
                      class="float-right" 
                      name="favorite-form">

                      <button 
                        class="btn btn-sm text-danger p-0 ml-1"
                        data-bs-toggle="tooltip" 
                        data-bs-placement="top" 
                        title="Remove from favorites" 
                        type="submit">
                          X
                      </button>
                    
                    </form>
                  </span>
                </li>
              </div>
              {% endfor %}
            
          </ul>
        
        </div>
        <div class="col-md col-lg-6">
          {% if favorites %}
          <form method="POST">
              {{ form.hidden_tag() }}
      
              {% for field in form if field.widget.input_type != 'hidden'%}
              <div class="form-group">
                {{field.label}}
                {{field(class_="form-control")}}
                {% for err in field.errors %}
                <small class="form-text text-danger">
                  {{err}}
                </small>
                {% endfor %}
              </div>
              {% endfor %}
              <button class="btn  btn-success  btn-lg">Submit</button>
            </form>
          {% endif %}
        </div>
      </div>
      
    </div>
  </div>
  
</div>
{% endblock %}